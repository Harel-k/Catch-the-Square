<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Catch the Square</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%2210 0 100 100%22><text y=%22.90em%22 font-size=%2290%22>üü•</text></svg>"></link>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Rubik:wght@400;700&display=swap');

    body {
      font-family: 'Rubik', sans-serif;
      text-align: center;
      margin: 0;
      background: linear-gradient(to right, #667eea, #764ba2);
      color: white;
      height: 100vh;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      transition: all 0.5s ease;
    }

    #gameArea {
      position: relative;
      width: 100vw;
      height: 70vh;
      overflow: hidden;
    }

    #box {
      width: 60px;
      height: 60px;
      background: #ff4d4d;
      position: absolute;
      cursor: pointer;
      border-radius: 15px;
      transition: all 0.2s;
      box-shadow: 0 0 15px rgba(0,0,0,0.3);
      animation: pop 0.3s ease;
    }

    .bonus {
      background: gold !important;
      box-shadow: 0 0 15px 5px yellow;
    }

    @keyframes pop {
      0% { transform: scale(0.7); opacity: 0.5; }
      100% { transform: scale(1); opacity: 1; }
    }

    button {
      margin: 10px;
      padding: 12px 28px;
      font-size: 20px;
      background: #00c9a7;
      border: none;
      border-radius: 30px;
      color: white;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      transition: background 0.3s, transform 0.2s;
    }

    button:hover {
      background: #00a088;
      transform: scale(1.05);
    }

    h1, h2 {
      text-shadow: 1px 1px 5px black;
    }

    #score, #timer {
      margin: 5px;
      font-size: 1.4em;
    }

    #homeScreen, #endScreen {
      display: none;
      flex-direction: column;
      align-items: center;
      animation: fadeIn 0.5s ease;
    }

    #gameUI {
      display: none;
      flex-direction: column;
      align-items: center;
    }

    #pauseBtn {
      position: absolute;
      top: 10px;
      right: 10px;
    }

    #modeSelect {
      margin-top: 10px;
      padding: 12px 25px;
      font-size: 18px;
      background: linear-gradient(135deg, #ffffff, #dfe6e9);
      color: #333;
      border: 2px solid #ccc;
      border-radius: 30px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      transition: all 0.3s ease;
      appearance: none;
      background-image: url('data:image/svg+xml;utf8,<svg fill="gray" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/></svg>');
      background-repeat: no-repeat;
      background-position-x: 95%;
      background-position-y: 50%;
    }

    #modeSelect:focus {
      outline: none;
      border-color: #00c9a7;
      box-shadow: 0 0 0 3px rgba(0, 201, 167, 0.4);
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>
  <div id="homeScreen">
    <h1>üéØ Catch the Square!</h1>
    <p>Click the square as many times as you can before time runs out!</p>
    <label for="modeSelect">Choose Mode:</label>
    <select id="modeSelect">
      <option value="normal">Normal (30 sec)</option>
      <option value="easy">Easy (45 sec)</option>
      <option value="hard">Hard (20 sec)</option>
      <option value="infinite">Infinite Mode</option>
    </select>
    <button id="startBtn">üöÄ Start Game</button>
    <p id="lastScore">Last Score: 0</p>
    <p id="bestScore">Best Score: 0</p>
  </div>

  <div id="gameUI">
    <div id="score">Score: 0</div>
    <div id="timer">Time: ‚àû</div>
    <button id="pauseBtn">‚èπ Exit</button>
    <div id="gameArea">
      <div id="box"></div>
    </div>
  </div>

  <div id="endScreen">
    <h2>üèÅ Game Over!</h2>
    <p id="finalScore">Your Score: 0</p>
    <p id="finalBest">Best Score: 0</p>
    <button id="restartBtn">üîÅ Play Again</button>
    <button id="homeBtn">üè† Home</button>
  </div>

  <audio id="clickSound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_aefb06e689.mp3?filename=mouse-click-153941.mp3"></audio>
  <audio id="bgMusic" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_4a56cd02c5.mp3?filename=happy-beat-111909.mp3" loop></audio>

  <script>
    const box = document.getElementById("box");
    const startBtn = document.getElementById("startBtn");
    const restartBtn = document.getElementById("restartBtn");
    const homeBtn = document.getElementById("homeBtn");
    const pauseBtn = document.getElementById("pauseBtn");
    const scoreText = document.getElementById("score");
    const timerText = document.getElementById("timer");
    const gameArea = document.getElementById("gameArea");
    const homeScreen = document.getElementById("homeScreen");
    const gameUI = document.getElementById("gameUI");
    const endScreen = document.getElementById("endScreen");
    const finalScore = document.getElementById("finalScore");
    const finalBest = document.getElementById("finalBest");
    const lastScore = document.getElementById("lastScore");
    const bestScoreDisplay = document.getElementById("bestScore");
    const clickSound = document.getElementById("clickSound");
    const bgMusic = document.getElementById("bgMusic");
    const modeSelect = document.getElementById("modeSelect");

    let score = 0;
    let bestScore = localStorage.getItem("bestScore") || 0;
    let lastScoreValue = localStorage.getItem("lastScore") || 0;
    let timer;
    let isInfinite = false;

    lastScore.textContent = "Last Score: " + lastScoreValue;
    bestScoreDisplay.textContent = "Best Score: " + bestScore;

    function randomPosition() {
      const areaWidth = gameArea.clientWidth;
      const areaHeight = gameArea.clientHeight;
      const x = Math.random() * (areaWidth - 60);
      const y = Math.random() * (areaHeight - 60);
      box.style.left = x + "px";
      box.style.top = y + "px";

      // 1 in 5 chance of bonus
      if (Math.random() < 0.2) {
        box.classList.add("bonus");
      } else {
        box.classList.remove("bonus");
      }
    }

    function endGame() {
      clearInterval(timer);
      box.style.display = "none";
      gameUI.style.display = "none";
      endScreen.style.display = "flex";
      finalScore.textContent = "Your Score: " + score;

      if (score > bestScore) {
        bestScore = score;
        localStorage.setItem("bestScore", bestScore);
      }
      finalBest.textContent = "Best Score: " + bestScore;
      localStorage.setItem("lastScore", score);
      bgMusic.pause();
    }

    function startGame() {
      score = 0;
      let mode = modeSelect.value;
      let timeLeft = 30;
      isInfinite = false;

      if (mode === "easy") timeLeft = 45;
      else if (mode === "hard") timeLeft = 20;
      else if (mode === "infinite") isInfinite = true;

      scoreText.textContent = "Score: 0";
      timerText.textContent = isInfinite ? "Time: ‚àû" : "Time: " + timeLeft;

      homeScreen.style.display = "none";
      endScreen.style.display = "none";
      gameUI.style.display = "flex";
      box.style.display = "block";
      randomPosition();

      bgMusic.currentTime = 0;
      bgMusic.play();

      clearInterval(timer);
      if (!isInfinite) {
        timer = setInterval(() => {
          timeLeft--;
          timerText.textContent = "Time: " + timeLeft;
          if (timeLeft <= 0) endGame();
        }, 1000);
      }

      box.onclick = () => {
        if (box.classList.contains("bonus")) {
          score += 5;
        } else {
          score++;
        }
        scoreText.textContent = "Score: " + score;
        randomPosition();
        clickSound.currentTime = 0;
        clickSound.play();
      };
    }

    startBtn.onclick = startGame;
    restartBtn.onclick = startGame;
    homeBtn.onclick = () => {
      endScreen.style.display = "none";
      homeScreen.style.display = "flex";
      lastScoreValue = localStorage.getItem("lastScore") || 0;
      lastScore.textContent = "Last Score: " + lastScoreValue;
    };
    pauseBtn.onclick = () => {
      clearInterval(timer);
      box.style.display = "none";
      gameUI.style.display = "none";
      homeScreen.style.display = "flex";
      bgMusic.pause();
      localStorage.setItem("lastScore", score);
      lastScore.textContent = "Last Score: " + score;
    };

    homeScreen.style.display = "flex";
  </script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <script>
    function fireConfetti() {
      confetti({
        particleCount: 150,
        spread: 100,
        origin: { y: 0.6 },
        colors: ['#00c9a7', '#ff4d4d', '#ffd700', '#764ba2']
      });
    }

    function endGame() {
      clearInterval(timer);
      box.style.display = "none";
      gameUI.style.display = "none";
      endScreen.style.display = "flex";
      finalScore.textContent = "Your Score: " + score;

      if (score > bestScore) {
        bestScore = score;
        localStorage.setItem("bestScore", bestScore);
        fireConfetti();
      }

      finalBest.textContent = "Best Score: " + bestScore;
      localStorage.setItem("lastScore", score);
      bgMusic.pause();
    }
  </script>
</body>
</html>
